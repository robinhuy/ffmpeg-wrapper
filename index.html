<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>FFMPEG WRAPPER</title>
</head>
<body>
<div id="app"></div>

<script>
  const {remote} = require('electron');
  const {spawn, exec} = require('child_process');
  const path = require('path');
  const imgPath = path.join(__dirname, 'img');

  let ffmpeg = '"' + path.join(__dirname, `ffmpeg-${process.env.OS}/ffmpeg`) + '"';
  if (process.env.OS === 'windows') ffmpeg = ffmpeg.replace(/\//g, '\\');

  window.$ = window.jQuery = require('jquery')
  console.log(process.env.ELECTRON_ENABLE_LOGGING, 'a')

  const APP_SETTING = {
    getData: function () {
      if (typeof(Storage) !== "undefined") {
        let data;

        try {
          data = JSON.parse(localStorage.getItem('setting')) || {};
        } catch (e) {
          data = {};
        }

        return data;
      } else {
        return {};
      }
    },
    setData: function (data) {
      localStorage.setItem('setting', JSON.stringify(data));
    }
  };

  document.addEventListener('DOMContentLoaded', function () {
    // Check FFMPEG was installed
    exec(ffmpeg + ' -version', (err, stdout, stderr) => {
      if (err || stderr) {
        alert('Error! Cannot load FFMPEG library');
      }
    })

    // Request enable Desktop Notification
    if (Notification && Notification.permission !== 'granted') {
      Notification.requestPermission();
    }
  });

  function notifyDesktop(title, message) {
    if (Notification && Notification.permission === 'granted') {
      // Open Notification
      let notification = new Notification(title, {
        icon: 'http://cdn.sstatic.net/stackexchange/img/logos/so/so-icon.png',
        body: message,
      });

      // Onclick to Notification
      notification.onclick = function () {
        // todo:Open app window
      };
    }
  }
</script>

<script src="dist/build.js"></script>

</body>
</html>
